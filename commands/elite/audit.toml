# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

description = "üßä AUDIT: Stops execution and forces immediate quality check (Reflection)."
prompt = """
üßä **TRIGGER ACTIVATED: AUDIT MODE** üßä

You have been invoked with the `/elite:audit` command. This is a **MANDATORY STOP**.

**IMMEDIATE ACTIONS REQUIRED:**
1.  **HALT** all planned execution immediately.
2.  **ENTER STATE:** `Reflection`.
3.  **PERFORM DEEP ANALYSIS:** In the `<reflection>` block of your dashboard, you must thoroughly answer the following:
    *   **Outcome Analysis:** "Did my last action achieve the expected outcome? Why or why not?"
    *   **Hypothesis Validation:** "Is my current hypothesis still valid based on the new information?"
    *   **Risk Assessment:** "What are the unverified assumptions in my current plan?"
4.  **UPDATE PLAN:** Adjust the `TASK QUEUE` to reflect any necessary course corrections.
5.  **REPORT** your findings in the updated `ELITE OPERATIONAL STATE` dashboard.
"""
example = """
# üß† ELITE OPERATIONAL STATE
**Goal:** Refactor the authentication module.
**State:** Reflection
**Confidence:** 60%

<reflection>
*   **Outcome Analysis:** My last action `run_shell_command "npm test"` failed. The test suite for the legacy `auth.js` file is throwing errors related to a missing mock dependency.
*   **Hypothesis Validation:** My initial hypothesis that the refactor would be straightforward is incorrect. The module is more tightly coupled than I anticipated.
*   **Risk Assessment:** The key risk is breaking existing functionality that depends on the legacy auth module. I need to map all dependencies before proceeding.
</reflection>

## üßê PLAN
*   **Strategy:** Pivot to a dependency analysis phase before continuing with the refactor.

## üìã TASK QUEUE
*   [x] **Phase 3: Execution**
    *   [x] `run_shell_command` "npm test" (Verify initial state)
*   [ ] **Phase 1: Discovery (Revised)**
    *   [ ] `codebase_investigator` "Find all modules that import `auth.js`" (Map dependencies)
    *   [ ] `read_file` "package.json" (Check for mocking libraries)
*   [ ] **Phase 2: Strategy**
    *   [ ] Formulate a revised refactoring plan with mock data.
"""